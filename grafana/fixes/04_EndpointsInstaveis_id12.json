{
  "datasource": { "type": "elasticsearch", "uid": "$DS_ELASTIC" },
  "fieldConfig": {
    "defaults": { 
      "color": { "mode": "palette-classic" }, 
      "mappings": [], 
      "unit": "short",
      "custom": {
        "displayMode": "auto"
      }
    },
    "overrides": [
      {
        "matcher": { "id": "byName", "options": "Std Deviation" },
        "properties": [{ "id": "unit", "value": "ms" }]
      },
      {
        "matcher": { "id": "byName", "options": "Variance" },
        "properties": [{ "id": "unit", "value": "ms" }]
      }
    ]
  },
  "gridPos": { "h": 8, "w": 12, "x": 12, "y": 22 },
  "id": 12,
  "options": { 
    "showHeader": true,
    "sortBy": [{ "displayName": "Std Deviation", "desc": true }]
  },
  "pluginVersion": "12.0.0",
  "targets": [
    {
      "alias": "Instabilidade",
      "bucketAggs": [
        {
          "field": "f5.url.keyword",
          "id": "2",
          "settings": { 
            "size": "20", 
            "order": "desc", 
            "orderBy": "_term"
          },
          "type": "terms"
        }
      ],
      "datasource": { "type": "elasticsearch", "uid": "$DS_ELASTIC" },
      "metrics": [
        { "field": "f5.request_elapsed_ms", "id": "1", "type": "avg" },
        { "field": "f5.request_elapsed_ms", "id": "3", "type": "min" },
        { "field": "f5.request_elapsed_ms", "id": "4", "type": "max" },
        { 
          "field": "f5.request_elapsed_ms", 
          "id": "5", 
          "type": "extended_stats",
          "meta": { "std_deviation": true, "variance": true }
        }
      ],
      "query": "f5.vhost.keyword:$vhost",
      "refId": "A",
      "timeField": "timestamp"
    }
  ],
  "transformations": [
    {
      "id": "organize",
      "options": {
        "excludeByName": {
          "Average": false,
          "Min": false,
          "Max": false
        },
        "renameByName": {
          "f5.url.keyword": "Endpoint",
          "Average": "Avg (ms)",
          "Min": "Min (ms)",
          "Max": "Max (ms)",
          "Std Deviation": "Std Deviation",
          "Variance": "Variance"
        }
      }
    },
    {
      "id": "sortBy",
      "options": {
        "fields": {},
        "sort": [{ "field": "Std Deviation", "desc": true }]
      }
    },
    {
      "id": "limit",
      "options": { "limitField": 10 }
    }
  ],
  "title": "Endpoints instáveis (por desvio padrão)",
  "transparent": true,
  "type": "table"
}
